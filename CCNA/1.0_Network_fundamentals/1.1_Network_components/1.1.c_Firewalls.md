# Firewalls

The **firewall** using so called "Firewall rules" to permit or deny traffic.<br>
The **firewall** should be the first line of defense and installed inline at the networkâ€™s perimeter.

Firewall rules are mostly based on

- Source
- Destination
- Port addresses

<img src="https://www.dropbox.com/s/8uq6fyowdi9i44u/firewall.png?dl=1" alt="firewall" class="inline" />

## Next-generation firewalls (NGFW)

**Next-Generation Firewall (NGFW)** (originally called **Unified Threat Management** (**UTM**)) provide multiple security features and services in a single device or service on the network:<br>
It is capable of deep-packet inspection that expands beyond port/protocol inspection and blocking to include application-level inspection (up to Layer 7).

**NGFW**s can use whitelists or a signature-based intrusion prevention system to distinguish between safe and malicious applications, which are then identified using SSL decryption.

**NGFW** acn include functions such as anti-virus, anti-spam, content filtering, and web filtering.

Advantages

- More secure
- Supports application-level inspection up to Layer 7 of the OSI model
- Capable of user authentication
- Detailed logging

Disadvantages

- Take a lot more system resources
- Can be more expensive than some firewall options
- Requires more fine-tuning to limit false positives and false negatives

### Intrusion Detection System

IDS is either a hardware or software program that analyzes incoming network traffic in real-time for malicious activities (_signatures or traffic patterns_) or policy breaches (_network behavior analysis_) and issues alerts when they are detected.

Unlike IPS, a network IDS is not in line with the data path, so it can only alert and alarm on detection of anomalies.

### Intrusion Prevention System

IPS is a device that inspects, detects, classifies, and proactively prevents harmful traffic.
It examines real-time communications for attack patterns or signatures and then blocks attacks when they have been detected.

Some of the actions of IPS include:

- Alerting network administrators (anomaly-based detection)
- Dropping the malicious traffic
- Denying traffic from the source address
- Reset the connection

[[Juniper Networks - What is utm?](https://www.juniper.net/us/en/research-topics/what-is-utm.html)]

## Stateful vs. Stateless Firewalls

### Stateful Firewalls

**Stateful firewalls** monitor all aspects of the traffic stream; their characteristics and commuinication channels.

A **stateful firewall** is located at **Layer 3** (source and destination IP addresses) and **Layer 4** (Transmission Control Protocol/TCP and User Datagram Protocol/UDP).

Advantages

- Connection state-aware
- Identify TCP connection stages
- Does not open a large range of ports to permit traffic
- Extensive logging capabilities
- Robust attack prevention
- Integrate encryption or tunnels

Disadvantages

- It can be complex to configure
- Cannot avoid application-level attacks
- Does not have user authentication capability
- Not all protocols have state information
- Additional overhead in maintaining state table

### Stateless Firewalls

**Stateless firewalls** (or packet-filtering firewalls) compare each packet received to s set of predefined criteria, such as

- Allowed IP addresses (source and destination)
- Packet type
- Port addresses

Preset rules enforce whether traffic is permitted or denied, but the system is typically unable to determine the difference between truly desired communications and sophisticated attempts to disguise unauthorized communications as trusted ones.

**Stateless firewalls** does not maintain a connection state table and don't look beyond the header of packet contents to determine if traffic is authorized.

Advantages

- A single device can filter traffic for an entire network
- Extremely fast processing of packets
- Inexpensive

Disadvantages

- It can be complex to configure and hard to manage
- Cannot avoid application-level attacks
- Does not have user authentication capability
- Limited logging capabilities
- Prone to certain types of TCP/IP protocol attacks

## Application-level Gateway Firewalls

**Application-level gateway firewalls** work on **Layer 7**.
They inspect and route internet traffic to and from the requested web address and the user.
Proxy firewalls are the most common type of application-level gateway firewalls.
The connections coming from outside the network are established through the proxy firewall.

Advantages

- Content caching
- Increased network performance
- Easier to log traffic
- Prevents direct connections from outside the network

Disadvantages

- Impact throughput capabilities
- Impact applications

## URL filtering

URL filtering limits access by comparing web traffic against a database to prevent employees from accessing harmful sites such as phishing pages.
Each website defined in the database is assigned to a URL category, or group, that firms can utilize in one of two ways:

1. Block or allow traffic based on URL category.
   Create a URL Filtering profile that specifies an action for each URL category and attach the profile to a policy.
   This includes categories for malware or phishing sites.
2. Match traffic based on URL category for policy enforcement.
   If the goal is for a specific policy rule to apply only to specific web traffic categories, add the category as match criteria when creating the policy rule.

[[Palo Alto networks - Cyberpedia](https://www.paloaltonetworks.com/cyberpedia/what-is-url-filtering)]

### DLP - Data Loss Prevention

[[McAfee](https://www.mcafee.com/enterprise/en-us/security-awareness/data-protection/how-data-loss-prevention-dlp-technology-works.html)]
