# Vulnerability Scanning

## Qualys VM Scanning Engine

Core Engine

- Inference-Based Scanning Engine.
- Intelligently launches modules specific to each unique host.
- Provides for optimal performance and accuracy.

Modules

- Collect configuration data form targeted hosts:
  - Open ports
  - Active services
  - Host operating system
  - Installed software applications
- Assessment modules are then launched based upon information collected.
- Hundreds of modules can coexist during a single scan.

## Data Collection Modules

- **Host discovery Module**
  - Requires: {IP ADDRESS}
  - Task: Checks if remote host is alive.
  - Produces: {HOST STATUS:HOST ALIVE/DEAD}

- **Port Scanning Module**
  - Requires: {HOST STATUS:HOST ALIVE/DEAD}
  - Task: Finds all open TCP/UDP ports.
  - Produces: {Open Ports}

- **Service Detection Module**
  - Requires: {Open Ports}
  - Task: Detects which service is running on an open port.
  - Produces: {Active Services}

- **OS Detection Module**
  - Requires: {Open Port}(at least one open TCP port)
  - Task: Detect host OS
  - Produces: {OS}

### Service Detection Module

> Note<br>
> Qualys VM can detect more than 600 different services on TCP and UDP ports.<br>
> To review these services, go to **Help > About** section.

- Detection by valid protocol negotiation (non-destructive).
- Some services may be configured to use non-standard ports numbers (contrary to IANA guidelines).
- Some services may use non-standard or unpredictable banners.
- Qualys will continue to negotiate communications, until the correct service is identified (may result service impact).

### OS Detection Module

- Authenticated scans provide the most accurate OS detection:
  - Collected directly from Windows Registry.
  - Unix command (e.g. `uname -a`, `cat /etc/redhat-release`, etc.).
  - Authentication also allows for the enumeration of installed software.

- Scans performed without authentication rely on TCP/IP stack fingerprinting with some enhanced protocol interrogation:
  - Packets are sent ot target host to collect replies and build an OS fingerprint (using TTL, MSS, window size, etc.).
  - More accurate results can potentially be obtained by interrogating useful protocols (e.g. NetBIOS, HTTP, SNMP, etc.).

## Vulnerability Assessment and Detection

Specific vulnerability modules are loaded based on:

- Host OS
- Active Services (and port numbers)
- Installed Software (authentication required)

- Active (non-intrusive) tests use template-based vulnerability signatures.
- Multiple tests validate each others' result to confirm the vulnerability.
